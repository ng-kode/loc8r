<div class="row">
    <div class="col-xs-12 col-sm-6">
        <p class="rating"><app-rating-stars [rating]="location.rating"></app-rating-stars></p>
        <p>{{location.address}}</p>
        <div class="panel panel-primary" *ngFor="let openingTime of location.openingTimes" [ngSwitch]="openingTime.closed">
            <div class="panel-heading">
                <h3 class="panel-title">Opening hour</h3>
            </div>
            <div class="panel-body">
                <span *ngSwitchCase="true">closed</span>
                <span *ngSwitchDefault>{{openingTime.days}}: {{openingTime.opening}} - {{openingTime.closing}}</span>
            </div>
        </div>
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Facilities</h3>
            </div>
            <div class="panel-body">
                <span class="label label-warning" *ngFor="let facility of location.facilities">
                    <span class="glyphicon glyphicon-ok"></span>{{facility}}
                </span>
            </div>
        </div>
    </div>
    <div class="col-xs-12 col-sm-6 location-map">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Location map</h3>
            </div>
            <div class="panel-body">
                <div class="thumbnail">
                    <img src="https://maps.googleapis.com/maps/api/staticmap?center={{location.coords[1]}},{{location.coords[0]}}&zoom=17&size=400x350&markers={{location.coords[1]}},{{location.coords[0]}}&scale=2&key={{googleapikey}}">
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-12">
        <div class="panel panel-primary review-panel">
            <div class="panel-heading">
                <button (click)="formVisible=true" class="btn btn-default pull-right">Add Review</button>
                <h3 class="panel-title">Reviews</h3>
            </div>
            <div class="panel-body review-container">
                <div class="row" *ngIf="formVisible">
                    <form id="addReview" class="col-xs-12" (ngSubmit)="onReviewSubmit()">
                        <div class="alert alert-danger" role="alert" *ngIf="formError">
                            {{ formError }}
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-sm-2" for="name">Name</label>
                            <div class="col-sm-10"><input class="form-control" type="text" [(ngModel)]="newReview.author" name="name" id="name"></div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-sm-2" for="rating">Rating</label>
                            <div class="col-sm-10">
                                <select class="form-control" name="rating" [(ngModel)]="newReview.rating" id="rating">
                                    <option [ngValue]="5">5</option>
                                    <option [ngValue]="4">4</option>
                                    <option [ngValue]="3">3</option>
                                    <option [ngValue]="2">2</option>
                                    <option [ngValue]="1">1</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-sm-2" for="reviewText">Review</label>
                            <div class="col-sm-10"><textarea class="form-control" name="reviewText" [(ngModel)]="newReview.reviewText" rows="8" cols="80" id="reviewText"></textarea></div>
                        </div>
                        <div class="form-group row">
                            <div class="col-xs-12">
                                <button type="submit" class="btn btn-default pull-right">Submit</button>
                                <button (click)="formVisible=false" class="btn btn-default pull-right">Cancel</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="row" *ngFor="let review of location.reviews | mostRecentFirst">
                    <div class="review">
                        <div class="well well-sm">
                            <span class="rating"><app-rating-stars [rating]="review.rating"></app-rating-stars></span>
                            &nbsp;
                            <span class="reviewAuthor">{{review.author}}</span>
                            &nbsp;
                            <span class="reviewTimestamp">{{review.createdOn | date: 'medium'}}</span>
                        </div>
                        <div class="col-xs-12">
                            <p>{{review.reviewText}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
